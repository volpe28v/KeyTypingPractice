# TODO リスト

## 🎯 完了済み

### バグ修正
- [x] **ミスカウント問題の完全修正** (v1.0.1)
  - 全レベル(Lv1-4)でミス回数が正しくカウントされない問題
  - プロキシ経由でGameManagerの正しい値を参照するように修正
  - 結果表示時に`window.mistakeCount`を使用
  - 正確率計算とパーフェクト判定も正常動作

- [x] **記録のクリア機能の不具合修正** (v1.0.1)
  - リロード後に記録が復活する問題
  - StorageManager/FirestoreManagerにclearAllRecords機能を追加
  - LocalStorageとFirestore両方から完全削除
  - 認証状態に関係なく正常動作

- [x] **Level2-4の音声バグ修正** (v1.0.0)
  - 単語完了後のexcellent/good音が正しく鳴動しない問題
  - GameManager.resetForNewWord()の適切な呼び出し

- [x] **完了画面表示問題の修正** (v1.0.0)
  - 「クリア」または「パーフェクト」画面で結果メッセージが一瞬で消える問題
  - タイマー管理とUI状態リセットで完全修正

- [x] **単語切り替え速度のパフォーマンス最適化** (v1.0.1)
  - ユーザーから単語切り替えが遅いとの声を受けて調査・修正
  - 遅延タイマーを大幅短縮：1500ms→600ms、500ms→300ms、1000ms→400ms
  - ユーザーフィードバックに基づく適切な速度バランスを実現

## 🚀 今後の改善提案

### Phase 1: プロキシパターンの完全統一 ⚡優先度：高
- [x] 全グローバル変数のプロキシ設定完了（GameManager経由）
- [x] mistakeCount, currentWordMistakeは完全にwindow経由でアクセス
- [ ] 他の主要変数もwindow.経由に統一（段階的に実施中）
- [ ] 不要なグローバル変数宣言を削除（リスク評価実施済み）

### Phase 2: TypeScript型定義の強化 📝優先度：中
- [ ] Window型定義を完全化
- [ ] any型を適切な型に置換 (43箇所の型警告)
- [ ] イベントハンドラーの型定義追加

### Phase 3: レベル処理の共通化 🔄優先度：中
- [ ] BaseLevelクラスの作成
- [ ] Lv2-4の共通処理を抽出
- [ ] 音声・UI更新の統一インターフェース

### Phase 4: Manager間の依存関係整理 🏗️優先度：低
- [ ] 循環参照の解消
- [ ] DIパターンの適用検討
- [ ] イベントベースの通信への移行

## 📊 バージョン履歴

### v1.0.1 (2024-XX-XX)
- ミスカウント問題の完全修正
- 記録のクリア機能の不具合修正

### v1.0.0
- 基本機能の実装完了
- Level1-4の実装
- Firebase連携
- TypeScript移行開始